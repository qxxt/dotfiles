#!/bin/bash

set -e
if [ -e $1-cache ]; then
        if [[ $(diff $1 $1-cache) == "" ]]; then
                echo -e '\033[0;31mRUN CACHED BINARY\033[0m'
                ./$1-bin
        else
                rustc $1 -o $1-bin && cp $1 $1-cache && ./$1-bin
        fi
else
        rustc $1 -o $1-bin && cp $1 $1-cache && ./$1-bin
fi
